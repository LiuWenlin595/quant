## 策略概述
这是一个专门用来交易**生猪期货**（也就是预测猪肉价格未来走势）的策略。它的主要目的是顺着市场的趋势赚钱：当猪肉价格趋势上涨时买入，当趋势下跌时卖出。

## 策略的核心思路
这个策略的核心想法是**“双重确认，顺势而为”**。

想象一下，你想去海边冲浪，你不仅要看海浪大不大（期货本身的价格走势），还要看看天气预报是不是也说有大风（参考相关的股票走势）。

1.  **顺势**：如果价格冲破了某个关口，说明力量很强，我们跟着买。
2.  **双重确认**：为了防止假动作，这个策略不仅看生猪期货的价格，还会看一家叫**“牧原股份”**的公司的股票。牧原是中国养猪的大龙头，如果它的股价在涨，说明大家看好猪肉市场，这时候买入生猪期货更安全。

## 具体操作步骤

### 第一步：选品（选择交易什么）
这个策略不选股票，而是专注于**生猪期货**（代码中是 `LH`）。
*   它会自动选择目前市场上交易最活跃的那个生猪合约（主力合约）。
*   **辅助参考**：它会盯着**牧原股份**（002714.XSHE）这只股票的表现，把它当作风向标。

### 第二步：买入/开仓（什么时候进场）
这个策略既可以买涨（做多），也可以买跌（做空）。

**情况A：买涨（觉得价格会升）**
你需要同时满足三个条件才会买入：
1.  **大势向好**：MACD指标大于0（说明上涨动力强）。
2.  **队友助攻**：牧原股份的股价趋势是向上的（过去5天收盘价整体表现不错）。
3.  **突破关口**：生猪期货的最新价格涨破了一个特定的“天花板”（代码中叫 `long_threshold`，通常是根据昨天的价格计算出的一个压力位）。

**情况B：买跌（觉得价格会降）**
同样需要满足三个条件：
1.  **大势向坏**：MACD指标小于0（说明下跌动力强）。
2.  **队友撤退**：牧原股份的股价趋势是向下的。
3.  **跌破地板**：生猪期货的最新价格跌破了一个特定的“地板价”（代码中叫 `short_threshold`）。

### 第三步：卖出/平仓（什么时候离场）
虽然代码片段中没有完全展示平仓的计算公式，但我们可以从设置中看到两个关键数字：
1.  **止盈（赚钱了跑）**：当赚到了 **3%** 的利润时（`g.win_ratio = 0.03`），落袋为安。
2.  **止损（亏钱了跑）**：当亏损达到 **3%** 时（`g.loss_ratio = 0.03`），赶紧卖出，防止亏更多。
3.  **收盘强平**：如果到了交割日或者特定时间，策略也会强制卖出。

## 使用的工具/指标

1.  **MACD（平滑异同移动平均线）**：
    *   **简单解释**：把它看作汽车的“速度计”。当它大于0，说明车在加速往前开（上涨）；小于0，说明车在倒车（下跌）。策略用它来判断大方向。

2.  **关联品种（牧原股份）**：
    *   **简单解释**：这是一种“跨界确认”。因为猪肉价格和养猪公司的股价通常是联动的。如果期货价格涨但养猪公司股价跌，可能就是假上涨，策略就不买。这能提高胜率。

3.  **Tick数据（高频数据）**：
    *   **简单解释**：策略不是每天看一次，而是时刻盯着每一次价格变动（Tick），一旦价格瞬间突破关口，立即下单。

## 风险控制

1.  **止损保护**：
    *   就像系了安全带，一旦亏损达到3%，系统自动砍仓，避免一次失误把本金亏光。

2.  **资金管理**：
    *   代码中有 `set_lots` 函数，这意味着它不会把所有钱一次性全押上，而是根据你的资金量计算该买多少手，防止仓位过重。

3.  **双重验证**：
    *   通过引入“牧原股份”作为参考，过滤掉了很多虚假的信号，这本身就是一种风险控制。

## 总结
这个策略就像一个**谨慎的冲浪者**。他想去冲浪（交易生猪期货），但他很守纪律：只有当**海浪够大**（MACD好+价格突破）**并且** **天气预报也说好**（牧原股份也在涨）的时候，他才下水。一旦发现情况不对（亏损3%）或者赚够了（盈利3%），他就立刻上岸。