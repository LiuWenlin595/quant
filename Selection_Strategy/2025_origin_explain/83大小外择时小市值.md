这是一个非常好的学习机会！这段代码虽然看起来很复杂，但它的核心逻辑其实非常贴近生活中的一些决策方式。

不用担心看不懂代码，我已经帮你把里面的核心秘密都翻译成了大白话。我们来看看这个策略是怎么帮你赚钱的。

## 策略概述
这个策略就像一个**灵活的猎人**，它主要盯着**市值很小**（公司规模小）的股票，因为这些股票通常爆发力强。但它也很聪明，如果发现大环境不好，它会考虑切换到大公司或者外国市场（ETF）去避险。

## 策略的核心思路
这个策略背后的想法主要有三点：
1.  **小船好调头，小股好翻倍**：它认为小市值的公司（小盘股）比大公司更容易涨起来，所以主要把钱投在这里。
2.  **优胜劣汰**：它只选那些虽然小，但是**在赚钱**（有利润、有收入）的好公司，把那些亏损的烂公司剔除掉。
3.  **跌了补仓，错了快跑**：如果买的股票跌了一点，它会尝试补仓拉低成本；但如果跌太多，它会果断止损认输。

---

## 具体操作步骤

### 第一步：选股（如何选择要买的股票）
这个策略有一个非常严格的筛选漏斗，只有通过层层选拔的股票才会被选中。

**它主要喜欢这样的股票（主要针对小市值部分）：**
1.  **剔除"坏"学生**：
    *   不买刚上市的新股（太不稳定）。
    *   不买被交易所警告的股票（ST股，有退市风险）。
    *   不买科创板（门槛太高，波动太大）。
2.  **只要"小"个子**：
    *   专门挑总市值在 **5亿到30亿** 之间的公司。这在股市里属于"小个子"，往往更有活力。
3.  **必须"身体健康"**：
    *   公司必须是**赚钱的**（净利润大于0）。
    *   公司必须有**正经生意**（营业收入大于1亿）。
4.  **最终排名**：
    *   在满足上面所有条件后，它会把所有股票按**市值从小到大**排队，选出最小的那几只。

*注：策略里也准备了"大公司"和"外国ETF"的名单，用来在市场风格变化时备用，但核心还是上面说的小公司。*

### 第二步：买入（什么时候买入）
这个策略比较勤快，它有两套买入逻辑：

1.  **定期换股（主要买入）**：
    *   它会**每周**或者**每月**检查一次。如果发现手里持有的股票已经不符合"最小、最好"的标准了，或者有更优秀的股票出现了，它就会卖出旧的，买入新的。
    *   它还会根据市场情况（虽然代码没显示完，但标题暗示了这一点），决定是买小公司、大公司还是外国基金。

2.  **抄底补仓（特殊买入）**：
    *   这是一个很有趣的操作。每天下午2点，它会检查手里的股票。
    *   如果发现某只股票**跌了**，但还没跌到止损线，它会觉得"这可能是个打折的好机会"。
    *   它会挑出跌得最惨的3只股票，用剩余的现金**再买一点**。这叫"摊低成本"，希望能等它反弹。

### 第三步：卖出（什么时候卖出）
卖出的规则非常明确，主要为了保住本金和利润：

1.  **止损卖出（保命）**：
    *   如果某只股票的价格跌到了你买入成本的 **85%**（也就是亏了15%），策略会毫不犹豫地**全部卖光**。这叫"截断亏损"，防止亏得底裤都不剩。
2.  **涨停打开卖出（落袋为安）**：
    *   如果一只股票昨天涨停了（涨得非常猛），但今天尾盘发现它封不住涨停板了（势头弱了），策略会立刻卖出。这就像"见好就收"。
3.  **短线补仓卖出（快进快出）**：
    *   还记得上面说的"抄底补仓"吗？那些补仓买进去的股票，策略只打算拿很短时间。到了**下周一**，不管赚没赚，它都会把这部分补仓的钱卖出来。这是一种做短线反弹的手法。

---

## 使用的工具/指标
这里用到了几个简单的概念，我帮你翻译一下：

1.  **市值 (Market Cap)**：
    *   **解释**：就是买下整个公司需要多少钱。
    *   **用途**：这个策略认为市值越小，将来成长的空间越大，所以用它来挑股票。
2.  **净利润 (Net Profit)**：
    *   **解释**：公司刨去所有成本后真正赚到口袋里的钱。
    *   **用途**：用来确保买的公司不是空壳子，是有真本事赚钱的。
3.  **涨停 (Limit Up)**：
    *   **解释**：中国股市规定，一天最多涨10%（或20%）。涨到顶了就叫涨停。
    *   **用途**：用来判断股票是不是特别强势。

---

## 风险控制
这个策略非常注重安全，它有三重保险：

1.  **硬止损**：亏15%强制离场，这是最后的防线。
2.  **不碰垃圾股**：选股时就过滤掉了亏损股和问题股，从源头减少风险。
3.  **分散投资**：它不会把钱全压在一只股票上，而是分散买几只（代码里设置了`g.stock_num`），这样就算一只股票暴雷，也不会赔光所有钱。

---

## 总结
简单来说，这个策略就是一个**"喜欢捡便宜好货的精明商人"**。

它专门在市场上寻找那些**规模很小、但正在赚钱**的公司。它相信这些小公司将来会变成大公司，从而带来丰厚的回报。同时，它非常守纪律：**亏多了就跑，涨不动了也跑，偶尔还会趁打折补一点货**。

对于初学者来说，这是一个经典的**"小市值轮动策略"**，利用了小公司容易暴涨的特性来获利。