这是一个非常经典的量化策略，结合了**“选最强的”**（动量轮动）和**“看天吃饭”**（择时）两个核心思想。

下面我用最通俗的语言为你拆解这个策略。

## 策略概述
这个策略就像是在赛马：它时刻盯着几匹马（ETF基金），哪匹马跑得最快就骑哪匹；但在骑马之前，它会先看天气（大盘环境），如果是狂风暴雨，就空仓休息，如果是好天气，就进场赚钱。

## 策略的核心思路
这个策略想赚两份钱：
1.  **赚趋势的钱**：相信“强者恒强”，过去一段时间涨得最好的股票，接下来大概率还会涨。
2.  **避开大跌的钱**：当整个市场环境变坏时，不管个股多好，大概率都会跌，所以这时候要果断空仓（卖出所有股票持有现金）。

## 具体操作步骤

### 第一步：选股（如何选择要买的股票）
策略并没有在几千只股票里大海捞针，而是关注了一个小范围的**“备选池”**，里面主要是几只代表不同方向的**ETF基金**（你可以理解为一篮子股票的集合）：
- **上证50ETF**（代表超大盘股）
- **沪深300ETF**（代表大盘股）
- **创业板500ETF**（代表中小盘成长股）
- **中证消费ETF**（代表消费行业）

**怎么选出最好的一只？**
1.  **看过去20天的表现**：策略会回看这些基金过去20天的价格走势。
2.  **去除杂音**：股票价格每天上蹿下跳，为了看清真实的趋势，策略用了一个叫**“卡尔曼滤波”**的工具（后面会解释），把锯齿状的价格曲线变得平滑，就像把照片磨皮一样，看清主要轮廓。
3.  **比谁爬坡快**：在平滑后的曲线上，计算谁的上涨角度最陡峭（斜率最大）。
4.  **选出冠军**：只选**第1名**的那只基金。

### 第二步：买入（什么时候买入）
选好了“冠军马”，能不能马上买？还不行，要先看“天气”。

策略使用了一个叫**RSRS**的方法来判断大盘（以沪深300指数为代表）是好是坏：
- **判断标准**：它计算出一个评分（RSRS分值）。
- **买入信号**：如果评分 **大于 0.7**，说明现在市场情绪高涨，是“好天气”。
- **执行**：如果“天气好” **且** 你手里没货，就全仓买入刚才选出的那只“冠军基金”。

### 第三步：卖出（什么时候卖出）
卖出有两种情况：

1.  **天气变坏了（清仓）**：
    - 每天早上策略都会算一下RSRS评分。
    - 如果评分 **小于 -0.7**，说明市场进入“暴雨区”，风险很大。
    - **操作**：不管你手里的基金是赚是赔，**全部卖出**，空仓持有现金，躲避风险。

2.  **换马（调仓）**：
    - 如果天气依然不好不坏（评分在 -0.7 到 0.7 之间）或者很好（大于0.7），策略会继续持有。
    - 但是，如果之前买的“冠军基金”现在跑不动了，变成了“亚军”或更差，而另一只基金变成了新的“冠军”。
    - **操作**：卖出旧的基金，买入新的“冠军基金”。这叫“轮动”。

## 使用的工具/指标

这里用了两个听起来很高级，但原理很简单的工具：

1.  **卡尔曼滤波 (Kalman Filter)**
    - **是什么**：一个数学工具。
    - **通俗解释**：想象你在遛狗，狗（价格）在绳子两边跑来跑去，但你（趋势）是稳定往前走的。卡尔曼滤波就是忽略狗的乱跑，只关注人的路线。它能帮策略不被股价短期的假动作骗到。

2.  **RSRS指标 (阻力支撑相对强度)**
    - **是什么**：一种判断大盘顶底的方法。
    - **通俗解释**：它通过分析每天最高价和最低价的关系，来判断市场是想涨还是想跌。
        - 就像弹簧，如果压得太紧（分值低），可能会崩盘；如果拉得顺畅（分值高），可能会继续涨。
    - **为什么用它**：这个指标在量化圈很出名，因为它对大跌的预警比较准确。

## 风险控制

1.  **大盘择时风控**：这是最主要的风控。通过RSRS指标，一旦大盘有大跌风险，策略会直接空仓。这能避免像2015年股灾那样的大亏损。
2.  **止损线（代码中设定的）**：代码里写了一个极端的止损：如果亏损超过90%就卖出。
    - *注意*：对于ETF来说，亏90%几乎不可能发生，所以这只是一个防止系统彻底崩溃的“最后一道防线”，平时基本用不上。真正的风控还是靠上面的“择时”。

## 总结

这个策略的逻辑非常清晰：
**“在天气好的时候（RSRS择时），挑跑得最快的那匹马（卡尔曼滤波+动量）骑；一旦天气变坏，立刻下马休息。”**

它不追求买在最低点，卖在最高点，而是追求在市场上涨的主升浪里，一直持有最强的那个品种。