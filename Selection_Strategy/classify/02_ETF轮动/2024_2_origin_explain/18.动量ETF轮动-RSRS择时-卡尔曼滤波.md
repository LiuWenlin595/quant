## 策略概述
这是一个**“追涨杀跌”但带有“安全开关”**的策略。它的主要工作是在几只指数基金（ETF）中，挑选涨势最好的一只买入。但是，在买入之前，它会先检查大盘的整体环境是否安全。如果大盘环境不好，它会空仓（什么都不买）以规避风险。

## 策略的核心思路
这个策略背后的想法非常朴素，主要由两个逻辑组成：

1.  **强者恒强（动量轮动）**：如果一只股票（或基金）最近涨得很好，那么它接下来继续涨的概率很大。就像赛跑一样，我们总是押注跑在第一名的那匹马。
2.  **顺势而为（大盘择时）**：覆巢之下无完卵。如果整个股市都在大跌，再好的股票也难独善其身。所以，只有在市场整体趋势向上时才进场，市场不好时就赶紧跑。

## 具体操作步骤

### 第一步：选股（挑选跑得最快的马）
策略关注了一个**备选池**，里面包含了几只代表不同市场风格的ETF基金（比如上证50、消费ETF、沪深300、创业板500等）。

**你是如何挑选的？**
1.  **看过去20天的表现**：你每天都会观察这些基金过去20天的价格走势。
2.  **去除杂音（卡尔曼滤波）**：股票价格每天都会上下波动，有时候是假动作。策略用了一种叫“卡尔曼滤波”的数学方法，把这些杂乱的波动过滤掉，画出一条平滑的曲线，看清它真实的走势。
3.  **比谁爬得陡（计算斜率）**：你看这条平滑曲线的“坡度”有多陡。坡度越陡，说明涨得越猛。
4.  **选第一名**：你把所有基金按坡度排名，只选**第一名**。

### 第二步：买入（看天气决定是否出门）
选好了想买的基金，能不能买呢？这要看“天气”（大盘环境）。策略使用**沪深300指数**作为大盘的风向标。

**判断规则（RSRS指标）：**
策略计算了一个叫**RSRS**的分数（后面会解释这是什么），用来给大盘打分：
*   **如果分数 > 0.7**：说明现在是“晴天”，市场很强。**买入**刚才选出的那只排名第一的基金。
*   **如果分数在 -0.7 到 0.7 之间**：说明天气不好不坏。如果你手里已经有股票了，就**继续持有**；如果没有，就不动。

### 第三步：卖出（风暴来了赶紧跑）
卖出主要有两种情况：

1.  **大盘变坏了**：
    *   如果RSRS分数 **< -0.7**：说明“暴风雨”来了，市场进入危险区。这时候不管你手里拿着什么，**全部卖出**，空仓避险。

2.  **换马（轮动）**：
    *   如果大盘环境还可以（分数 > -0.7），但是你手里拿的这只基金不再是第一名了，你就把它卖掉，换成新的第一名。

## 使用的工具/指标

这里用了两个听起来很高级，但原理很简单的工具：

1.  **卡尔曼滤波 (Kalman Filter)**
    *   **是什么**：你可以把它想象成一副**“降噪耳机”**。
    *   **为什么用**：股价每天上蹿下跳，有时候很难看清真正的趋势。这个工具能把那些无意义的抖动过滤掉，让你看清股价真正想去的方向。

2.  **RSRS指标 (阻力支撑相对强度)**
    *   **是什么**：这是一个用来判断大盘是强还是弱的温度计。
    *   **为什么用**：它通过分析最高价和最低价的关系，来判断现在的价格是容易涨（支撑强）还是容易跌（阻力大）。
    *   **简单理解**：
        *   分数高 = 大家都想买，价格跌不下去 = **买入信号**
        *   分数低 = 大家都想卖，价格涨不上去 = **卖出信号**

## 风险控制

这个策略主要靠**“择时”**来控制风险：

1.  **大盘风控**：这是最核心的。一旦RSRS指标发出危险信号（小于 -0.7），策略会强制清仓。这就避免了在股灾或大跌行情中死扛，保住本金。
2.  **止损保护**：代码里还写了一个极端的止损线（亏损超过90%卖出），但这在实际运行中几乎不会触发，主要起到底层兜底的作用。

## 总结
这个策略就像一个**聪明的赛马手**：
1.  他戴着“降噪耳机”（卡尔曼滤波），专心观察哪匹马最近跑得最快、最稳（动量选股）。
2.  在下注前，他会先看天气预报（RSRS择时）。
3.  如果是晴天，他就买跑第一的那匹马；如果是暴风雨，他就空手休息，绝不冒险。