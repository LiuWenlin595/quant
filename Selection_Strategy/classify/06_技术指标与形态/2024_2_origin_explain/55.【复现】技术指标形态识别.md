# 量化策略解释：自动“看图找规律”策略

## 策略概述
这个策略是利用计算机算法，自动在股票走势图中寻找像“头肩底”、“三角形”这样特殊的形状，并根据这些形状来预测股价接下来是涨还是跌。

## 策略的核心思路
你可能听说过有些老股民喜欢看K线图，说“走出这个形状就要涨了”。这个策略的核心想法就是：**历史是会重演的，特定的图形往往预示着特定的结果。**

但是，人的眼睛看图容易看花眼，或者带有主观偏见。这个策略就是**用数学公式代替人的眼睛**：
1.  先把锯齿状的股价走势线“磨平”，去掉杂音，只看大趋势。
2.  然后用计算机自动去匹配经典的图形（比如“头肩顶”、“双底”等）。
3.  一旦匹配成功，就认为捕捉到了买卖信号。

简单来说，这就是一个**不知疲倦的、客观的“看图机器人”**。

## 具体操作步骤

### 第一步：选股（如何选择要买的股票）
在这个策略的代码中，它主要关注的是**整个行业**的表现（比如“申万一级行业”，意思就是把股票分成“医药”、“科技”、“银行”等大类）。
*   **你的做法**：你不需要盯着几千只具体的股票，而是让计算机去扫描这些大行业的指数。
*   **为什么**：看行业比看单个股票更稳定，不容易被某一家公司的突发消息干扰。

### 第二步：处理数据（给K线图“磨皮”）
在寻找图形之前，策略做了一个非常关键的动作，叫做**核回归平滑（Kernel Regression）**。
*   **通俗解释**：股票每天的价格跳上跳下，像心电图一样有很多毛刺。如果直接看，很难看出规律。这个步骤就像是用修图软件给K线图“磨皮”，把那些细小的波动过滤掉，画出一条圆润、光滑的曲线。
*   **为什么**：只有去掉了噪点，才能看清真正的山峰和山谷在哪里。

### 第三步：买入（什么时候买入）
当计算机在那个“磨皮”后的曲线上，识别出属于**“底部”**的形状时，就是买入信号。
*   **具体形状**：
    *   **头肩底 (Inverse Head & Shoulders)**：像一个人倒立的头和肩膀，通常意味着跌到底了，要反弹。
    *   **底部发散/三角形底**：价格波动的范围在特定的收缩或扩张中触底。
*   **操作**：一旦计算机喊出“发现头肩底！”，这就意味着下跌趋势可能结束了，你可以考虑**买入**。

### 第三步：卖出（什么时候卖出）
当计算机识别出属于**“顶部”**的形状时，就是卖出信号。
*   **具体形状**：
    *   **头肩顶 (Head & Shoulders)**：像一个正常站立的人的头和肩膀（中间高，两边低），通常意味着涨到头了，要跌了。
    *   **顶部发散/三角形顶**：价格在高位震荡，力量耗尽。
*   **操作**：一旦计算机喊出“发现头肩顶！”，这就意味着上涨趋势可能结束了，你应该**卖出**止盈。

## 使用的工具/指标

这个策略没有使用常见的MACD或KDJ指标，而是用了一套专门的**数学算法**：

1.  **核回归（Kernel Regression）**：
    *   **是什么**：这就是上面说的“磨皮工具”。
    *   **作用**：它能根据过去一段时间的价格，画出一条最能代表当前趋势的光滑曲线。

2.  **形态识别算法**：
    *   **是什么**：这是一本“形状字典”。
    *   **作用**：代码里写好了一堆规则，比如“如果中间的峰值最高，两边的峰值低一点，且高度差不多，这就是头肩顶”。计算机拿着这个字典去比对那条光滑曲线。

## 风险控制

代码中包含了一部分专门用来**“事后诸葛亮”**（回测分析）的功能，用来评估风险：

1.  **计算胜率**：
    *   策略会统计：每次识别出图形后，过了3天、5天、10天，价格是真的按预期走了吗？如果识别出“底部”后价格真的涨了，就算赢。
    *   **作用**：让你知道哪个行业的哪种图形最准，只做胜率高的，避开胜率低的。

2.  **计算盈亏比**：
    *   策略会计算：赚的时候平均赚多少，亏的时候平均亏多少。
    *   **作用**：确保你不是“赚小钱亏大钱”。

## 总结

这个策略就是一个**“自动化的图形猎人”**。

它不关心公司的业绩好坏，也不看新闻，它只相信**价格的形状**。它先用数学方法把杂乱的股价变成光滑的曲线，然后拿着放大镜在曲线里找“头肩底”、“三角形”等经典形状。**看到底部形状就买，看到顶部形状就卖**，并且通过统计历史胜率来告诉你，这个形状到底准不准。